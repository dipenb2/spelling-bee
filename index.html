<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8">
  <title>Bangla Spelling Bee</title>
  <style>
    body {
      font-family: "Noto Sans Bengali", system-ui, sans-serif;
      text-align: center;
      margin: 0;
      padding: 20px;
    }
    .board {
      position: relative;
      width: 260px;
      height: 260px;
      margin: 40px auto;
    }
    .hex {
      position: absolute;
      width: 70px;
      height: 70px;
      line-height: 70px;
      border-radius: 15px;
      display: inline-block;
      background: #eee;
      font-size: 32px;
      cursor: pointer;
      user-select: none;
    }
    .center {
      background: #ffd400;
      left: 95px; top: 95px;
    }
    .hex.p0 { left: 95px; top: 20px; }
    .hex.p1 { left: 175px; top: 65px; }
    .hex.p2 { left: 175px; top: 155px; }
    .hex.p3 { left: 95px; top: 200px; }
    .hex.p4 { left: 15px; top: 155px; }
    .hex.p5 { left: 15px; top: 65px; }

    #current {
      font-size: 28px;
      margin: 10px 0;
      min-height: 32px;
    }
    button {
      margin: 5px;
      padding: 6px 14px;
      font-size: 16px;
    }
    #found {
      max-width: 320px;
      margin: 15px auto;
      text-align: left;
      font-size: 16px;
    }
    #message {
      min-height: 22px;
      margin-top: 6px;
      color: #444;
    }
  </style>
  <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Noto+Sans+Bengali&display=swap">
</head>
<body>

<h2>বাংলা Spelling Bee – ডেমো</h2>
<p>মাঝের অক্ষরটি অবশ্যই ব্যবহার করে কমপক্ষে ৩ অক্ষরের শব্দ বানান।</p>

<div class="board" id="board"></div>

<div id="current"></div>
<p>স্কোর: <span id="score">0</span></p>

<button id="delete">মুছুন</button>
<button id="shuffle">ঘুরান</button>
<button id="enter">এন্টার</button>

<div id="message"></div>

<h3>আপনি যেগুলো পেয়েছেন:</h3>
<div id="found"></div>

<script>
// --- পাজল সেটআপ ---
const puzzle = {
  center: "ক",
  letters: ["ম","ল","ত","ন","র","আ"],  // আ আছে, later আ-কার হবে
  validWords: [
    "কলম",
    "কমলা",
    "কলতান",
    "করলা",
    "কালা",
    "কাম"
  ]
};

// --- গ্লোবাল স্টেট ---
let current = "";
let score = 0;
let found = [];

// আ-কার লজিক
const AKAR_TILE = "আ";   // বাটনে যা লেখা
const AKAR_SIGN = "া";   // আসল আ-কার (U+09BE)

// --- বোর্ড আঁকা ---
function renderBoard() {
  const board = document.getElementById("board");
  board.innerHTML = "";

  // center
  const centerDiv = document.createElement("div");
  centerDiv.className = "hex center";
  centerDiv.textContent = puzzle.center;
  centerDiv.onclick = () => addLetter(puzzle.center);
  board.appendChild(centerDiv);

  // around letters
  puzzle.letters.forEach((ch, i) => {
    const div = document.createElement("div");
    div.className = "hex p" + i;
    div.textContent = ch;
    div.onclick = () => addLetter(ch);
    board.appendChild(div);
  });
}

// --- আ/অক্ষর যোগ করার লজিক ---
function addLetter(ch) {
  if (ch === AKAR_TILE) {
    applyAkar();     // আ চাপলে আগের বর্ণে আ-কার বসাই
  } else {
    current += ch;   // অন্য সব অক্ষর সরাসরি যোগ
  }
  document.getElementById("current").textContent = current;
}

// আ-কার প্রয়োগ: ল → লা, ত → তা, ন → না ইত্যাদি
function applyAkar() {
  if (!current) {
    // একদম শুরুতে আ চাপলে "আ" ই থাকবে
    current += AKAR_TILE;
    return;
  }
  const lastChar = current[current.length - 1];
  current = current.slice(0, -1) + lastChar + AKAR_SIGN;
}

// --- অন্য হেল্পার ---
function clearCurrent(msg = "") {
  current = "";
  document.getElementById("current").textContent = "";
  document.getElementById("message").textContent = msg;
}

function scoreWord(w) {
  // ৩ অক্ষর = ১, ৪ = ২, ৫+ = দৈর্ঘ্য
  if (w.length === 3) return 1;
  if (w.length === 4) return 2;
  return w.length;
}

// --- সাবমিট ---
function submitWord() {
  const w = current;

  // মিনিমাম দৈর্ঘ্য
  if (w.length < 3) {
    clearCurrent("কমপক্ষে ৩ অক্ষর হতে হবে।");
    return;
  }

  // মাঝের অক্ষর থাকতে হবে
  if (!w.includes(puzzle.center)) {
    clearCurrent("মাঝের অক্ষরটি থাকতে হবে!");
    return;
  }

  // allowed অক্ষর চেক
  const allowed = new Set([puzzle.center, ...puzzle.letters]);
  // যদি টাইলসে "আ" থাকে, তাহলে "া"-কেও allow করি
  if (allowed.has(AKAR_TILE)) {
    allowed.add(AKAR_SIGN);
  }

  for (const ch of w) {
    if (!allowed.has(ch)) {
      clearCurrent("এই অক্ষর ব্যবহার করা যাবে না: " + ch);
      return;
    }
  }

  // ডিকশনারি চেক
  if (!puzzle.validWords.includes(w)) {
    clearCurrent("ডিকশনারিতে এই শব্দ নেই।");
    return;
  }

  // ডুপ্লিকেট?
  if (found.includes(w)) {
    clearCurrent("এই শব্দটি আগেই পাওয়া হয়েছে।");
    return;
  }

  // স্কোর আপডেট
  found.push(w);
  score += scoreWord(w);
  document.getElementById("score").textContent = score;
  document.getElementById("found").textContent = found.join(", ");
  clearCurrent("দারুণ! ✔");
}

// --- বাটন হ্যান্ডলার ---
document.getElementById("delete").onclick = () => clearCurrent();
document.getElementById("shuffle").onclick = () => {
  puzzle.letters.sort(() => Math.random() - 0.5);
  renderBoard();
};
document.getElementById("enter").onclick = submitWord;

// প্রথমবার বোর্ড রেন্ডার
renderBoard();
</script>

</body>
</html>

